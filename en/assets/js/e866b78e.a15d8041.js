"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5458],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=a.createContext({}),d=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(i.Provider,{value:t},e.children)},l="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),l=d(n),m=r,h=l["".concat(i,".").concat(m)]||l[m]||u[m]||o;return n?a.createElement(h,s(s({ref:t},p),{},{components:n})):a.createElement(h,s({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=m;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c[l]="string"==typeof e?e:r,s[1]=c;for(var d=2;d<o;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6685:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>l,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const o={title:"Change Deeply Nested State\uff1f"},s=void 0,c={unversionedId:"advanced/sickof-changing-nested-state",id:"advanced/sickof-changing-nested-state",title:"Change Deeply Nested State\uff1f",description:"Deeply nested object, Sick of reducers and changing nested state\uff1f",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/advanced/sickof-changing-nested-state.md",sourceDirName:"advanced",slug:"/advanced/sickof-changing-nested-state",permalink:"/zustand-vue/en/docs/advanced/sickof-changing-nested-state",draft:!1,editUrl:"https://github.com/AwesomeDevin/zustand-vue/tree/main/docs/docs/advanced/sickof-changing-nested-state.md",tags:[],version:"current",frontMatter:{title:"Change Deeply Nested State\uff1f"},sidebar:"tutorialSidebar",previous:{title:"Middleware",permalink:"/zustand-vue/en/docs/basic/middleware"},next:{title:"Want Reducers And ActionTypes Like Redux\uff1f",permalink:"/zustand-vue/en/docs/advanced/no-reducer-action"}},i={},d=[{value:"Normal",id:"normal",level:2},{value:"immer",id:"immer",level:2},{value:"optics-ts",id:"optics-ts",level:2},{value:"Ramda",id:"ramda",level:2}],p={toc:d};function l(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Deeply nested object, Sick of reducers and changing nested state\uff1f"),(0,r.kt)("p",null,"If you have a Deeply ",(0,r.kt)("inlineCode",{parentName:"p"},"object")," like this\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"type State = {\n  deep: {\n    nested: {\n      obj: { count: number },\n      ...{} // more\n    }\n  }\n}\n")),(0,r.kt)("p",null,"Updating nested state requires some effort to ensure the process is completed immutably."),(0,r.kt)("h2",{id:"normal"},"Normal"),(0,r.kt)("p",null,"Similar to React or Redux, the normal approach is to copy each level of the state object. This is done with the spread operator ",(0,r.kt)("inlineCode",{parentName:"p"},"..."),", and by manually merging that in with the new state values. Like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"  normalInc: () =>\n    set((state) => ({\n      deep: {\n        ...state.deep,\n        nested: {\n          ...state.deep.nested,\n          obj: {\n            ...state.deep.nested.obj,\n            count: state.deep.nested.obj.count + 1\n          }\n        }\n      }\n    })),\n")),(0,r.kt)("p",null,"It's too Long! Let's explore some ways you can make your coding life better, easier, and less hair-shedding."),(0,r.kt)("h2",{id:"immer"},(0,r.kt)("a",{parentName:"h2",href:"https://github.com/immerjs/immer"},"immer")),(0,r.kt)("p",null,"Many people use Immer to update nested values. Immer can be used anytime you need to update nested state such as in React, Redux and of course, Zustand!"),(0,r.kt)("p",null,"You can use Immer to shorten your state updates for deeply nested object. Let's take a look at an example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import produce from 'immer'\n\nconst useStore = create((set) => ({\n  deep: {\n    nested: {\n      obj: { count: 0 },\n    }\n  },\n  immerInc: () =>\n    set(\n      produce((state: State) => {\n        ++state.deep.nested.obj.count\n      })\n    ),\n}))\n\nconst immerInc = useStore((state) => state.immerInc)\nimmerInc()\n")),(0,r.kt)("p",null,"What a reduction! I think it saved your hair\uff0cPlease take note of the gotchas listed here.(",(0,r.kt)("a",{parentName:"p",href:"https://github.com/pmndrs/zustand/blob/main/docs/integrations/immer-middleware.md)%E3%80%82"},"https://github.com/pmndrs/zustand/blob/main/docs/integrations/immer-middleware.md)\u3002")),(0,r.kt)("h2",{id:"optics-ts"},(0,r.kt)("a",{parentName:"h2",href:"https://github.com/akheron/optics-ts/"},"optics-ts")),(0,r.kt)("p",null,"There is another option with ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/akheron/optics-ts/"},"optics-ts")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import * as O from 'optics-ts'\n\nconst useStore = create((set) => ({\n  deep: {\n    nested: {\n      obj: { count: 0 },\n    }\n  },\n  opticsInc: () =>\n    set(\n      O.modify(O.optic<State>().path(\"deep.nested.obj.count\"))((c) => c + 1)\n    ),\n}))\n\nconst opticsInc = useStore((state) => state.opticsInc)\nopticsInc()\n")),(0,r.kt)("h2",{id:"ramda"},(0,r.kt)("a",{parentName:"h2",href:"https://ramdajs.com/"},"Ramda")),(0,r.kt)("p",null,"You can also use ",(0,r.kt)("a",{parentName:"p",href:"https://ramdajs.com/"},"Ramda")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import * as O from \'optics-ts\'\n\nconst useStore = create((set) => ({\n  deep: {\n    nested: {\n      obj: { count: 0 },\n    }\n  },\n  ramdaInc: () =>\n    set(\n      R.over(R.lensPath(["deep", "nested", "obj", "count"]), (c) => c + 1)\n    ),\n}))\n\nconst ramdaInc = useStore((state) => state.ramdaInc)\nramdaInc()\n')),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://codesandbox.io/s/zustand-normal-immer-optics-ramda-updating-ynn3o?file=/src/App.tsx"},"Code Demo")))}l.isMDXComponent=!0}}]);